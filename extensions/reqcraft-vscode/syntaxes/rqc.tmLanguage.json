{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "ReqCraft",
  "scopeName": "source.rqc",
  "patterns": [
    { "include": "#comments" },
    { "include": "#import" },
    { "include": "#config" },
    { "include": "#category" },
    { "include": "#api" },
    { "include": "#websocket" },
    { "include": "#socketio" },
    { "include": "#annotations" },
    { "include": "#types" },
    { "include": "#strings" },
    { "include": "#numbers" }
  ],
  "repository": {
    "comments": {
      "patterns": [
        { "name": "comment.line.double-slash.rqc", "match": "//.*$" },
        { "name": "comment.block.rqc", "begin": "/\\*", "end": "\\*/" }
      ]
    },
    "import": {
      "match": "^\\s*(import)\\s+(\"[^\"]+\")",
      "captures": {
        "1": { "name": "keyword.control.import.rqc" },
        "2": { "name": "string.quoted.double.rqc" }
      }
    },
    "config": {
      "begin": "\\b(config)\\s*\\{",
      "end": "\\}",
      "beginCaptures": { "1": { "name": "keyword.declaration.rqc" } },
      "patterns": [
        { "include": "#baseUrl" },
        { "include": "#configVariable" },
        { "include": "#configHeader" },
        { "include": "#configBoolean" },
        { "include": "#comments" }
      ]
    },
    "baseUrl": {
      "begin": "\\b(baseUrl)\\s+",
      "end": "$",
      "beginCaptures": { "1": { "name": "variable.other.property.rqc" } },
      "patterns": [
        { "name": "punctuation.separator.comma.rqc", "match": "\\s*,\\s*" },
        { "name": "string.unquoted.url.rqc", "match": "https?://[-a-zA-Z0-9_.:/?#\\[\\]@!$&'()*+;=%~]+" }
      ]
    },
    "configVariable": {
      "begin": "\\b(variable)\\s+([a-zA-Z_][a-zA-Z0-9_]*)",
      "end": "$|(?=\\})",
      "beginCaptures": {
        "1": { "name": "keyword.declaration.rqc" },
        "2": { "name": "variable.other.rqc" }
      },
      "patterns": [
        { "name": "support.type.primitive.rqc", "match": "\\b(String|Number|Boolean)\\b" },
        {
          "begin": "\\b(default)\\s*(\\()",
          "end": "(\\))",
          "beginCaptures": {
            "1": { "name": "storage.modifier.decorator.rqc" },
            "2": { "name": "punctuation.brackets.round.rqc" }
          },
          "endCaptures": { "1": { "name": "punctuation.brackets.round.rqc" } },
          "patterns": [{ "include": "#literal-values" }]
        }
      ]
    },
    "configHeader": {
      "begin": "\\b(header)\\s+([a-zA-Z_][a-zA-Z0-9_-]*)",
      "end": "$|(?=\\})",
      "beginCaptures": {
        "1": { "name": "keyword.declaration.rqc" },
        "2": { "name": "variable.other.rqc" }
      },
      "patterns": [
        { "include": "#annotations" }
      ]
    },
    "configBoolean": {
      "match": "\\b(mock|cors)\\s+(true|false)\\b",
      "captures": {
        "1": { "name": "variable.other.property.rqc" },
        "2": { "name": "constant.language.boolean.rqc" }
      }
    },
    "category": {
      "begin": "\\b(category)\\s+([a-zA-Z_][a-zA-Z0-9_]*)\\s*\\{",
      "end": "\\}",
      "beginCaptures": {
        "1": { "name": "keyword.declaration.rqc" },
        "2": { "name": "entity.name.type.rqc" }
      },
      "patterns": [
        { "include": "#properties" },
        { "include": "#category" },
        { "include": "#api" },
        { "include": "#websocket" },
        { "include": "#socketio" },
        { "include": "#strings" },
        { "include": "#comments" }
      ]
    },
    "api": {
      "begin": "\\b(api)\\s+(/[^\\s{]*)\\s*\\{",
      "end": "\\}",
      "beginCaptures": {
        "1": { "name": "keyword.declaration.rqc" },
        "2": { "name": "string.unquoted.path.rqc" }
      },
      "patterns": [
        { "include": "#http-methods" },
        { "include": "#comments" }
      ]
    },
    "websocket": {
      "begin": "\\b(ws)\\s+(\\S+)\\s*\\{",
      "end": "\\}",
      "beginCaptures": {
        "1": { "name": "keyword.declaration.rqc" },
        "2": { "name": "string.unquoted.url.rqc" }
      },
      "patterns": [
        { "include": "#ws-event" },
        { "include": "#comments" }
      ]
    },
    "socketio": {
      "begin": "\\b(socketio)\\s+(\\S+)\\s*\\{",
      "end": "\\}",
      "beginCaptures": {
        "1": { "name": "keyword.declaration.rqc" },
        "2": { "name": "string.unquoted.url.rqc" }
      },
      "patterns": [
        { "include": "#ws-event" },
        { "include": "#comments" }
      ]
    },
    "ws-event": {
      "begin": "\\b(event)\\s+([a-zA-Z_][a-zA-Z0-9_]*)\\s*\\{",
      "end": "\\}",
      "beginCaptures": {
        "1": { "name": "keyword.other.event.rqc" },
        "2": { "name": "entity.name.function.rqc" }
      },
      "patterns": [
        { "include": "#properties" },
        { "include": "#request-response" },
        { "include": "#comments" }
      ]
    },
    "http-methods": {
      "begin": "\\b(get|post|put|delete|patch)\\s*\\{",
      "end": "\\}",
      "beginCaptures": { "1": { "name": "keyword.other.http-method.rqc" } },
      "patterns": [
        { "include": "#properties" },
        { "include": "#request-response" },
        { "include": "#comments" }
      ]
    },
    "properties": {
      "match": "\\b(name|desc|prefix)\\s+(\"[^\"]+\")",
      "captures": {
        "1": { "name": "variable.other.property.rqc" },
        "2": { "name": "string.quoted.double.rqc" }
      }
    },
    "request-response": {
      "begin": "\\b(request|response)\\s*\\{",
      "end": "\\}",
      "beginCaptures": { "1": { "name": "keyword.other.block.rqc" } },
      "patterns": [
        { "include": "#fields" },
        { "include": "#annotations" },
        { "include": "#comments" }
      ]
    },
    "fields": {
      "patterns": [
        {
          "begin": "\\b([a-zA-Z_][a-zA-Z0-9_]*)\\s*\\{",
          "end": "\\}\\??",
          "beginCaptures": { "1": { "name": "variable.other.field.rqc" } },
          "patterns": [
            { "include": "#fields" },
            { "include": "#annotations" },
            { "include": "#comments" }
          ]
        },
        {
          "match": "\\b([a-zA-Z_][a-zA-Z0-9_]*)\\s+(String|Number|Boolean|Any)(\\?)?",
          "captures": {
            "1": { "name": "variable.other.field.rqc" },
            "2": { "name": "support.type.primitive.rqc" },
            "3": { "name": "keyword.operator.optional.rqc" }
          }
        },
        { "include": "#annotations" }
      ]
    },
    "annotations": {
      "patterns": [
        {
          "begin": "(@)(mock|example)\\s*(\\()",
          "end": "(\\))",
          "beginCaptures": {
            "1": { "name": "storage.modifier.decorator.rqc" },
            "2": { "name": "storage.modifier.decorator.rqc" },
            "3": { "name": "punctuation.brackets.round.rqc" }
          },
          "endCaptures": { "1": { "name": "punctuation.brackets.round.rqc" } },
          "patterns": [{ "include": "#literal-values" }]
        },
        {
          "match": "(@)([a-zA-Z_][a-zA-Z0-9_]*)\\b",
          "captures": {
            "1": { "name": "storage.modifier.decorator.rqc" },
            "2": { "name": "storage.modifier.decorator.rqc" }
          }
        }
      ]
    },
    "literal-values": {
      "patterns": [
        {
          "name": "string.quoted.double.rqc",
          "begin": "\"", "end": "\"",
          "patterns": [{ "name": "constant.character.escape.rqc", "match": "\\\\." }]
        },
        { "name": "constant.language.boolean.rqc", "match": "\\b(true|false)\\b" },
        { "name": "constant.language.null.rqc", "match": "\\bnull\\b" },
        { "name": "constant.numeric.rqc", "match": "-?\\d+(\\.\\d+)?([eE][+-]?\\d+)?" }
      ]
    },
    "types": {
      "match": "\\b(String|Number|Boolean|Any)\\b",
      "name": "support.type.primitive.rqc"
    },
    "strings": {
      "name": "string.quoted.double.rqc",
      "begin": "\"", "end": "\"",
      "patterns": [{ "name": "constant.character.escape.rqc", "match": "\\\\." }]
    },
    "numbers": {
      "name": "constant.numeric.rqc",
      "match": "\\b\\d+(\\.\\d+)?\\b"
    }
  }
}
